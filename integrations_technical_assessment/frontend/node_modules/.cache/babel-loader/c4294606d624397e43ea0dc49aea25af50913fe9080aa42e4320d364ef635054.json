{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bharg\\\\Downloads\\\\automations_technical_assessment\\\\integrations_technical_assessment\\\\frontend\\\\src\\\\integrations\\\\hubspot.js\",\n  _s = $RefreshSig$();\n// hubspot.js\n\nimport { useState, useEffect } from 'react';\nimport { Box, Button, CircularProgress } from '@mui/material';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const HubSpotIntegration = ({\n  user,\n  org,\n  integrationParams,\n  setIntegrationParams\n}) => {\n  _s();\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const handleConnectClick = async () => {\n    try {\n      setIsConnecting(true);\n      const form = new FormData();\n      form.append('user_id', user);\n      form.append('org_id', org);\n      // Backend returns the authorization URL\n      const {\n        data: authUrl\n      } = await axios.post('http://localhost:8000/integrations/hubspot/authorize', form);\n      const width = 600,\n        height = 700;\n      const left = window.screenX + (window.outerWidth - width) / 2;\n      const top = window.screenY + (window.outerHeight - height) / 2;\n      const popup = window.open(authUrl, 'hubspot_oauth', `width=${width},height=${height},left=${left},top=${top}`);\n\n      // Poll the backend for credentials while popup is open\n      const poll = async () => {\n        try {\n          const credForm = new FormData();\n          credForm.append('user_id', user);\n          credForm.append('org_id', org);\n          const res = await axios.post('http://localhost:8000/integrations/hubspot/credentials', credForm);\n          if (res !== null && res !== void 0 && res.data) {\n            setIntegrationParams({\n              type: 'HubSpot',\n              credentials: res.data\n            });\n            setIsConnected(true);\n            setIsConnecting(false);\n            if (popup && !popup.closed) popup.close();\n            return;\n          }\n        } catch (e) {\n          // ignore until available\n        }\n        if (popup && !popup.closed) {\n          setTimeout(poll, 1200);\n        } else {\n          setIsConnecting(false);\n        }\n      };\n      setTimeout(poll, 1200);\n    } catch (e) {\n      var _e$response, _e$response$data;\n      setIsConnecting(false);\n      alert((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.detail) || 'Failed to initiate OAuth.');\n    }\n  };\n  useEffect(() => {\n    setIsConnected(Boolean(integrationParams === null || integrationParams === void 0 ? void 0 : integrationParams.credentials));\n  }, [integrationParams]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mt: 2\n      },\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        sx: {\n          mt: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          children: \"OAuth\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleConnectClick,\n          variant: \"contained\",\n          disabled: isConnecting || isConnected,\n          style: {\n            pointerEvents: isConnected ? 'none' : 'auto',\n            cursor: isConnected ? 'default' : 'pointer',\n            opacity: isConnected ? 1 : undefined\n          },\n          children: isConnected ? 'HubSpot Connected' : isConnecting ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 73\n          }, this) : 'Connect to HubSpot'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n_s(HubSpotIntegration, \"YVzh0k4rAm9dKRmEfKk5oscD40o=\");\n_c = HubSpotIntegration;\nvar _c;\n$RefreshReg$(_c, \"HubSpotIntegration\");","map":{"version":3,"names":["useState","useEffect","Box","Button","CircularProgress","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","HubSpotIntegration","user","org","integrationParams","setIntegrationParams","_s","isConnected","setIsConnected","isConnecting","setIsConnecting","handleConnectClick","form","FormData","append","data","authUrl","post","width","height","left","window","screenX","outerWidth","top","screenY","outerHeight","popup","open","poll","credForm","res","type","credentials","closed","close","e","setTimeout","_e$response","_e$response$data","alert","response","detail","Boolean","children","sx","mt","display","alignItems","justifyContent","fileName","_jsxFileName","lineNumber","columnNumber","onClick","variant","disabled","style","pointerEvents","cursor","opacity","undefined","size","_c","$RefreshReg$"],"sources":["C:/Users/bharg/Downloads/automations_technical_assessment/integrations_technical_assessment/frontend/src/integrations/hubspot.js"],"sourcesContent":["\r\n// hubspot.js\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    Box,\r\n    Button,\r\n    CircularProgress\r\n} from '@mui/material';\r\nimport axios from 'axios';\r\n\r\nexport const HubSpotIntegration = ({ user, org, integrationParams, setIntegrationParams }) => {\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    const [isConnecting, setIsConnecting] = useState(false);\r\n\r\n    const handleConnectClick = async () => {\r\n        try {\r\n            setIsConnecting(true);\r\n            const form = new FormData();\r\n            form.append('user_id', user);\r\n            form.append('org_id', org);\r\n            // Backend returns the authorization URL\r\n            const { data: authUrl } = await axios.post('http://localhost:8000/integrations/hubspot/authorize', form);\r\n            const width = 600, height = 700;\r\n            const left = window.screenX + (window.outerWidth - width) / 2;\r\n            const top = window.screenY + (window.outerHeight - height) / 2;\r\n            const popup = window.open(authUrl, 'hubspot_oauth', `width=${width},height=${height},left=${left},top=${top}`);\r\n\r\n            // Poll the backend for credentials while popup is open\r\n            const poll = async () => {\r\n                try {\r\n                    const credForm = new FormData();\r\n                    credForm.append('user_id', user);\r\n                    credForm.append('org_id', org);\r\n                    const res = await axios.post('http://localhost:8000/integrations/hubspot/credentials', credForm);\r\n                    if (res?.data) {\r\n                        setIntegrationParams({\r\n                            type: 'HubSpot',\r\n                            credentials: res.data\r\n                        });\r\n                        setIsConnected(true);\r\n                        setIsConnecting(false);\r\n                        if (popup && !popup.closed) popup.close();\r\n                        return;\r\n                    }\r\n                } catch (e) {\r\n                    // ignore until available\r\n                }\r\n                if (popup && !popup.closed) {\r\n                    setTimeout(poll, 1200);\r\n                } else {\r\n                    setIsConnecting(false);\r\n                }\r\n            };\r\n            setTimeout(poll, 1200);\r\n        } catch (e) {\r\n            setIsConnecting(false);\r\n            alert(e?.response?.data?.detail || 'Failed to initiate OAuth.');\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        setIsConnected(Boolean(integrationParams?.credentials));\r\n    }, [integrationParams]);\r\n\r\n    return (\r\n        <>\r\n        <Box sx={{mt: 2}}>\r\n            <Box display='flex' alignItems='center' justifyContent='space-between' sx={{mt: 2}}>\r\n                <Box>OAuth</Box>\r\n                <Button\r\n                    onClick={handleConnectClick}\r\n                    variant='contained'\r\n                    disabled={isConnecting || isConnected}\r\n                    style={{\r\n                        pointerEvents: isConnected ? 'none' : 'auto',\r\n                        cursor: isConnected ? 'default' : 'pointer',\r\n                        opacity: isConnected ? 1 : undefined\r\n                    }}\r\n                >\r\n                    {isConnected ? 'HubSpot Connected' : isConnecting ? <CircularProgress size={20} /> : 'Connect to HubSpot'}\r\n                </Button>\r\n            </Box>\r\n        </Box>\r\n      </>\r\n    );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}